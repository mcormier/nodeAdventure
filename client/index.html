<html>
<head>
  <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
  <script src="http://mcormier.github.io/js/PPUtils-1.0.0.js"></script>

  <link rel="stylesheet" type="text/css" href="client.css">
</head>
<body>

  <div id="narrative">
    <div id="workarea">

      <div class="startScreen">
      You are on Argyle street on a cold December night.
      To the south is the door to the Diamond.
      To the east is the door to the Backstage Bar.
      To the north is the door to the Economy Shoe Shop.
      </div>

      <div class="console">
      &gt; 
        <input id="console" maxlength="40" />
      </div>

    </div>
  </div>

  <script>

    var local = false;

    var socket;
    if (local) {
     socket  = io.connect('http://127.0.0.1:8080');
     console.log("Running in local test mode");
    } else  {
      socket = io.connect('http://nodejs-catts.rhcloud.com:8000');
    }

    socket.on('display text', function(msg) {
       console.log("Message from server: " + msg );
       var display = $("workarea");
       var newDiv = document.createElement("div");
       var t = document.createTextNode(msg);
       newDiv.appendChild(t);
       display.appendChild(newDiv);
    });

    socket.on('stories', function (msg) {
       console.log("Received story list " + msg);
    });


    function handleEnter(e) {
      // TODO -- magic number
      if (e.keyCode == 13 ) {
        var command = $("console").value;
        socket.emit('command', command);
        console.log("TODO -- clear input field");
      }
    }

    PPUtils.bind('keyup', $("console"), handleEnter)

  </script>


</body>
</html>
